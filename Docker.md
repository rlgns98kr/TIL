# Docker

- 오픈소스 컨테이너 프로젝트
- 소프트웨어를 하나의 단위 모듈로 구성
- 전세계적으로 큰 인기
- MS Azure, Google, AWS(amazon) 에서 공식 지원
- 개발, 테스트, 서비스 환경을 하나로 통일하여 효율적 관리
- 컨테이너를 공유할 수 있다!
- 리눅스 커널에서 제공하는 컨테이너 기술을 이용



## 가상화

- 여러 서버에 복사하여 사용할 수 있다.
- 가상화 기술을 이용하는 것이 클라우드 서비스
- 가상화에서 컴퓨터를 통째로 만들어내다 보니 성능 손실이 발생(VMware)

- 가장 큰 단점은 느리다.
- 소프트웨어 추상화를 통하여 가상화



## 반가상화

- 호스트와 커널을 공유하는 반가상화 기술
  - 커널은 물리적인 시스템리소스와 드라이버를 연결해주는 역할
- 커널을 공유한다는 말은 결구 호스트와 운영체제를 이용하는 것
- 따라서 운영체제에 필요한 비용을 줄일 수 있고 속도향상을 이룰 수 있다.



## 리눅스 컨테이너

- 컨테이너 안에 가상공간을 만들지만 실행 파일을 호스트에서 직접 실행
- 가상화가 아닌 격리 -> 다른 프로세서의 간섭을 막는다.



## 도커

### 도커의 특징

- 호스트OS -> 도커 엔진 -> 실행 파일 -> 어플리케이션 A
- 도커는 게스트 OS를 설치하지 않음
- 호스트 OS의 자원을 100% 활용(성능 차이가 크지 않음)
- 이미지에 서버 운영을 위한 프로그램과 라이브러리만 격리해서 설치(용량 절감)

- 이미지 생성과 배포에 특화
- 다양한 API 제공
- MSA

### 이미지

- 서비스 운영에 픨요한 서버 프로그램, 소스 코드, 컴파일된 실행 파일 등의 묶음
- 저장소에 올리고 받는다.
- 객체, 실행파일

### 컨테이너

- 컨테이너는 이미지를 실행한 상태
- 인스턴스, 프로세스

### 이미지 처리 방식

- 베이스 이미지에서 바뀐 부분만 이미지로 생성
- 베이스 이미지와 바뀐 부분을 합쳐서 실행
- 공유되는 부분들이 한번만 실행된다.

### 서버

- 물리서버를 직접 운영
- 가상화가 발전하면서 클라우드 환경의 변화
- 가상 서버를 임대하여 사용한 만큼만 요금 지불
- 서버 대수가 많아지면서 일일이 세팅하기 힘들어짐

### Immutable Infrastructure

- 한 번 설정한 운영 환경은 변경하지 않는다는 개념
- 모듈화를 통하여 추가나 변경이 일어날 시 운영 환경을 유지하면서 모듈을 변경함

- 서비스가 업데이트되면 이미지를 새로 생성하여 배포
- 운영환경 이미지를 한번 쓰고 버림(?)
- 관리가 편리, 확장, 테스트, 가볍다

### 명령어

- docker image build -> 이미지를 빌드한다.
- docker image ls -> 이미지 목록
- docker image tag 이미지경로:원래태그 이미지경로:바꿀태그 -> 이미지 태그를 변경한다.(버젼관리)
- docker container run *path:tag* -> 컨테이너를 실행한다.
- docker container ps -> 컨테이너 실행목록
- docker container stop *id or name* -> 아이디나 네임으로 컨테이너를 중지한다.
- docker container ls -q -> 실행중인 모든 컨테이너 아이디 리턴

### Docker hub

- DockerhubID/이미지 이름:태그 -> 형식을 준수
- docker login  -> 도커허브에 로그인
- docker image push DockerhubID/이미지 이름:태그 -> 이미지 등록



## 포트포워딩

- NAT 환경에서 호스트 PC의 아이피의 포트 중 하나와 게스트 PC의 서버(IP:port)와 1대 1 mapping 시키는 것
- 사용자는 호스트PC의 아이피:포트번호로 게스트 PC의 서버에 접속가능하다.

